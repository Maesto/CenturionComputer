; Key code capture by ren14500. Public domain.
TITLE 'KEYCODES'
SYSTEM ZKEYCODES(MAIN,EXP=D)
FILE CRT:SYSIPT,CLASS=1,SEQ
FORMAT F0:N11
STRING TWO(2)
STRING ONE(1)
RECORD CMDREC(1)
  STRING CMD(1)
ENDREC
INTEGER KEYCODE
ENTRYPOINT CRT
ENTRY
OPEN IO(CRT)
'CMD'="'0'"
'TWO'="'00'"\'TWO'="'0'"\'TWO'="''"
TOP:
  READB(CRT,CMDREC)
  'ONE'='CMD'
  IF(TWO.GE.128)KEYCODE=TWO-128
  ELSE KEYCODE=TWO
  WRITE(CRT,F0)KEYCODE
  IFS(CMD.EQ.'Q')GO TO DONE
  GO TO TOP
DONE:
CLOSE CRT
STOP 0
END

