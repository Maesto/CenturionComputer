.NOLOG
.SETA 0=100
.SETA 1=1
.SETC 2=Q
.NOTIME
.RUN S.XEJECT
/==============================================================================
/                      ACTIVITY CODES TO MASTER FILE
/                 KEY: #0      DISK: #1      PRINTER: #2
/==============================================================================
/
/  ENTER FUNCTION:   1 - ENTER/UPDATE MEMBERSHIP ACTIVITY TRANSACTION FILE
/                    2 - PRINT MEMBERSHIP ACTIVITY TRANSACTION FILE
/
/                    3 - POST TRANSACTION FILE TO CHURCH MEMBERSHIP FILE
/
/                   98 - CHANGE KEY/DISK/PRINTER
/                   99 - END OF PROCESSING
/
/==============================================================================
/  AWAITING RESPONSE
.ENTER UPSI
.SETA 9=#U
.SETA UPSI=0
.SKIP 1 IF 99 NE #9
S.CON
.SKIP TO CHG IF 98 EQ #9
.SKIP 2 IF 0 GE #9
.SKIP 1 IF  5 LE #9
.SKIP TO OPT#9
.SKIPR 0
=CHG
/  ENTER KEY
.ENTER 0
/  ENTER DISK
.ENTER 1
/  ENTER PRINTER OR CRT
.ENTER 2
.SKIPR 0
=OPT1
.USE CH#0Z  ON #1 FOR SYS0 SHAR
.USE CH.CHSM92 ON #D FOR SYS1 SHAR
.USE CH#0A  ON #1 FOR SYS2 SHAR
.SETC 4 EQ CH#0Z
.SETC 8 EQ #I
.RUN ASMLIB.XMAINT ON #S
.END
.SKIPR 0
=OPT2
.USE CH#0Z  ON #1 FOR SYS1 SHAR
.USE CH#0Z  ON #1 FOR SYS0 SHAR
.USE SORT1#I ON #S FOR SYS2
.USE SORT2#I ON #S FOR SYS3
.USE SORT3#I ON #S FOR SYS4
.USE SORT4#I ON #S FOR SYS5
.RUN S.DSORT
INPMOD=(,XAISRT)
PRINT=NO,FILTYP=C,INPUT=1,WORK=4,OUTPUT=INP
RECSIZ= 96
KEY=(1,4,BI),/*
.END
.USE CH.CHRM92 ON #D FOR SYS0 SHAR
.USE CH#0Z  ON #1 FOR SYS1
.USE CH#0A  ON #1 FOR SYS2 SHAR
.SKIP 2 IF CRT NE #2
.USE CRT#V FOR SYS10
.SKIP 1
.USE PRT#2 FOR SYS10
.RUN ASMLIB.XREPRT ON #S
.END
.SKIPR 0
=OPT3
/
/     ARE YOU READY TO POST ACTIVITIES TO MASTER FILE - Y/N?
.ENTER 9
.SKIPR 0 IF #9 NE Y
.USE CH.CHPM93 ON #D FOR SYS0 SHAR
.USE CH#0Z  ON #1 FOR SYS1 SHAR
.USE CH#0A  ON #1 FOR SYS2 SHAR
.SKIP 2 IF CRT NE #2
.USE CRT#V FOR SYS10
.SKIP 1
.USE PRT#2 FOR SYS10
.RUN ASMLIB.XPOST  ON #S
.END
.SKIPR 0











